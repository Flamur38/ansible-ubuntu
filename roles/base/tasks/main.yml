- name: Update apt cache
  apt:
    update_cache: yes

- name: Upgrade system (allow downgrades for pinned packages)
  become: true
  apt:
    upgrade: dist
    allow_downgrade: true

- name: Install essential packages
  apt:
    name:
      - curl
      - wget
      - git
      - ca-certificates
      - build-essential
      - unzip
    state: present


- name: Set timezone
  timezone:
    name: "{{ timezone }}"

- name: Generate locale
  locale_gen:
    name: "{{ locale }}"
    state: present

- name: Set system locale
  command: localectl set-locale LANG={{ locale }}
  changed_when: false

- name: Set hostname (optional)
  hostname:
    name: "{{ hostname }}"
  when: hostname | length > 0

